CREATE TABLE ADMIN (id int IDENTITY(1, 1) NOT NULL, usuarioId int NOT NULL, PRIMARY KEY (id));
CREATE TABLE CARACTER (id int IDENTITY(1, 1) NOT NULL, name varchar(255) NOT NULL UNIQUE, PRIMARY KEY (id));
CREATE TABLE CURSO (id int IDENTITY(1, 1) NOT NULL, nombre varchar(255) NOT NULL, sigla varchar(255) NULL UNIQUE, descripcion varchar(1024) NULL, PRIMARY KEY (id));
CREATE TABLE ESTADO_TUTORIA (id int IDENTITY(1, 1) NOT NULL, nombre varchar(255) NOT NULL UNIQUE, PRIMARY KEY (id));
CREATE TABLE ESTUDIANTE (usuarioId int NOT NULL, id int IDENTITY(1, 1) NOT NULL, PRIMARY KEY (id));
CREATE TABLE EVALUACION (id int IDENTITY(1, 1) NOT NULL, participacionTutor varchar(255) NULL, evaluacionGeneral int NULL, partipacionTutorando varchar(255) NULL, puntosAgendaAbarcados varchar(255) NULL, completitud varchar(255) NULL, practica varchar(255) NULL, foro varchar(255) NULL, PRIMARY KEY (id));
CREATE TABLE FECHA (fechaInicio datetime NOT NULL, fechaFin datetime NOT NULL, tutorId int NOT NULL, available int NOT NULL, id int IDENTITY(1, 1) NOT NULL, PRIMARY KEY (id));
CREATE TABLE FECHA_TUTORIA (fechaId int NOT NULL, tutoriaId int NOT NULL, PRIMARY KEY (fechaId, tutoriaId));
CREATE TABLE MATERIALES (path varchar(255) NOT NULL, usuarioId int NOT NULL, cursoId int NOT NULL, nombre varchar(255) NULL, PRIMARY KEY (path, usuarioId, cursoId));
CREATE TABLE MENSAJE (contenido varchar(255) NOT NULL, fecha datetime NOT NULL, id int IDENTITY(1, 1) NOT NULL, remitente int NOT NULL, receptor int NOT NULL, PRIMARY KEY (id));
CREATE TABLE MODALIDAD (id int IDENTITY(1, 1) NOT NULL, nombre varchar(255) NOT NULL UNIQUE, PRIMARY KEY (id));
CREATE TABLE MODALIDAD_TUTOR (modalidadId int NOT NULL, tutorId int NOT NULL, PRIMARY KEY (modalidadId, tutorId));
CREATE TABLE PLATAFORMA (id int IDENTITY(1, 1) NOT NULL, nombre varchar(255) NOT NULL UNIQUE, PRIMARY KEY (id));
CREATE TABLE PLATAFORMA_TUTOR (plataformaId int NOT NULL, tutorId int NOT NULL);
CREATE TABLE REGION (nombre varchar(255) NOT NULL UNIQUE, id int IDENTITY(1, 1) NOT NULL, PRIMARY KEY (id));
CREATE TABLE RETRIBUCION (tipo varchar(255) NOT NULL UNIQUE, id int IDENTITY(1, 1) NOT NULL, PRIMARY KEY (id));
CREATE TABLE TIPO_SESION (id int IDENTITY(1, 1) NOT NULL, nombre varchar(255) NOT NULL UNIQUE, PRIMARY KEY (id));
CREATE TABLE TIPO_SESION_TUTOR (tipoSesionId int NOT NULL, tutorId int NOT NULL, PRIMARY KEY (tipoSesionId, tutorId));
CREATE TABLE TUTOR (id int IDENTITY(1, 1) NOT NULL, calificacion int NULL, cantidadTutoriasAgendadas int NULL, cantidadMinutosAgendados int NULL, retribucionId int NOT NULL, usuarioId int NOT NULL, costoHoraPersona money NULL, incrementoTarifaIndividual money NULL, costoHoraGrupal money NULL, incrementoTarifaGrupal money NULL, maxEstud int NULL, PRIMARY KEY (id));
CREATE TABLE TUTOR_CURSO (tutorId int NOT NULL, cursoId int NOT NULL, ano int NOT NULL, periodo int NOT NULL, id int IDENTITY(1, 1) NOT NULL, PRIMARY KEY (id));
CREATE TABLE TUTORIA (id int IDENTITY(1, 1) NOT NULL, fechaInicial datetime NULL, fechaFinal datetime NULL, retribucionId int NOT NULL, cantidadEstudiantes int NOT NULL, tutorCursoId int NOT NULL, estadoTutoriaId int NOT NULL, plataformaId int NOT NULL, caracterId int NOT NULL, modalidad int NOT NULL, tipoSesionId int NOT NULL, costoTotal money NOT NULL, PRIMARY KEY (id));
CREATE TABLE TUTORIA_ESTUDIANTE (tutoriaId int NOT NULL, tutoriaEstudianteId int IDENTITY(1, 1) NOT NULL UNIQUE, horaIngreso datetime NULL, horaEgreso datetime NULL, evaluacionId int NULL, estudianteId int NOT NULL, PRIMARY KEY (tutoriaId, tutoriaEstudianteId, estudianteId));
CREATE TABLE USUARIO (correo varchar(255) NOT NULL UNIQUE, apellido varchar(255) NOT NULL, primerNombre varchar(255) NOT NULL, id int IDENTITY(1, 1) NOT NULL, region int NOT NULL, PRIMARY KEY (id));
ALTER TABLE TUTORIA_ESTUDIANTE ADD CONSTRAINT FKTUTORIA_ES742782 FOREIGN KEY (tutoriaId) REFERENCES TUTORIA (id);
ALTER TABLE TUTORIA_ESTUDIANTE ADD CONSTRAINT FKTUTORIA_ES250634 FOREIGN KEY (estudianteId) REFERENCES ESTUDIANTE (id);
ALTER TABLE TUTOR_CURSO ADD CONSTRAINT FKTUTOR_CURS619959 FOREIGN KEY (tutorId) REFERENCES TUTOR (id);
ALTER TABLE TUTOR_CURSO ADD CONSTRAINT FKTUTOR_CURS475368 FOREIGN KEY (cursoId) REFERENCES CURSO (id);
ALTER TABLE TUTORIA ADD CONSTRAINT FKTUTORIA940490 FOREIGN KEY (tutorCursoId) REFERENCES TUTOR_CURSO (id);
ALTER TABLE MATERIALES ADD CONSTRAINT FKMATERIALES822439 FOREIGN KEY (cursoId) REFERENCES CURSO (id);
ALTER TABLE TUTORIA ADD CONSTRAINT FKTUTORIA105584 FOREIGN KEY (estadoTutoriaId) REFERENCES ESTADO_TUTORIA (id);
ALTER TABLE TUTORIA ADD CONSTRAINT FKTUTORIA664431 FOREIGN KEY (plataformaId) REFERENCES PLATAFORMA (id);
ALTER TABLE TUTORIA ADD CONSTRAINT FKTUTORIA970793 FOREIGN KEY (caracterId) REFERENCES CARACTER (id);
ALTER TABLE MODALIDAD_TUTOR ADD CONSTRAINT FKMODALIDAD_594736 FOREIGN KEY (modalidadId) REFERENCES MODALIDAD (id);
ALTER TABLE MODALIDAD_TUTOR ADD CONSTRAINT FKMODALIDAD_856289 FOREIGN KEY (tutorId) REFERENCES TUTOR (id);
ALTER TABLE TIPO_SESION_TUTOR ADD CONSTRAINT FKTIPO_SESIO373553 FOREIGN KEY (tipoSesionId) REFERENCES TIPO_SESION (id);
ALTER TABLE TIPO_SESION_TUTOR ADD CONSTRAINT FKTIPO_SESIO378436 FOREIGN KEY (tutorId) REFERENCES TUTOR (id);
ALTER TABLE TUTORIA ADD CONSTRAINT FKTUTORIA95917 FOREIGN KEY (modalidad) REFERENCES MODALIDAD (id);
ALTER TABLE TUTORIA ADD CONSTRAINT FKTUTORIA733980 FOREIGN KEY (tipoSesionId) REFERENCES TIPO_SESION (id);
ALTER TABLE ADMIN ADD CONSTRAINT FKADMIN486761 FOREIGN KEY (usuarioId) REFERENCES USUARIO (id);
ALTER TABLE USUARIO ADD CONSTRAINT FKUSUARIO848992 FOREIGN KEY (region) REFERENCES REGION (id);
ALTER TABLE PLATAFORMA_TUTOR ADD CONSTRAINT FKPLATAFORMA481056 FOREIGN KEY (plataformaId) REFERENCES PLATAFORMA (id);
ALTER TABLE PLATAFORMA_TUTOR ADD CONSTRAINT FKPLATAFORMA127479 FOREIGN KEY (tutorId) REFERENCES TUTOR (id);
ALTER TABLE FECHA_TUTORIA ADD CONSTRAINT FKFECHA_TUTO107414 FOREIGN KEY (fechaId) REFERENCES FECHA (id);
ALTER TABLE FECHA_TUTORIA ADD CONSTRAINT FKFECHA_TUTO862149 FOREIGN KEY (tutoriaId) REFERENCES TUTORIA (id);
ALTER TABLE TUTORIA_ESTUDIANTE ADD CONSTRAINT [CALIFICADA POR] FOREIGN KEY (evaluacionId) REFERENCES EVALUACION (id);
ALTER TABLE TUTOR ADD CONSTRAINT [COBRA CON] FOREIGN KEY (retribucionId) REFERENCES RETRIBUCION (id);
ALTER TABLE FECHA ADD CONSTRAINT [DISPONE DE] FOREIGN KEY (tutorId) REFERENCES TUTOR (id);
ALTER TABLE ESTUDIANTE ADD CONSTRAINT ES_ESTUDIANTE FOREIGN KEY (usuarioId) REFERENCES USUARIO (id);
ALTER TABLE TUTOR ADD CONSTRAINT ES_TUTOR FOREIGN KEY (usuarioId) REFERENCES USUARIO (id);
ALTER TABLE MENSAJE ADD CONSTRAINT Recibe FOREIGN KEY (receptor) REFERENCES USUARIO (id);
ALTER TABLE MENSAJE ADD CONSTRAINT Remite FOREIGN KEY (remitente) REFERENCES USUARIO (id);
ALTER TABLE TUTORIA ADD CONSTRAINT SE_PAGA_CON FOREIGN KEY (retribucionId) REFERENCES RETRIBUCION (id);
ALTER TABLE MATERIALES ADD CONSTRAINT SUBE FOREIGN KEY (usuarioId) REFERENCES USUARIO (id);
ALTER TABLE FECHA ADD CONSTRAINT UQ_FECHA UNIQUE(fechaInicio, fechaFin, tutorId, available);